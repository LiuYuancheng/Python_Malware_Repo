{% extends 'base.html' %}

{% block title %} User Action scheduler Monitor {% endblock %}

{% block link %} <link rel="stylesheet" href="https://cdn.datatables.net/1.10.2/css/jquery.dataTables.min.css"> {% endblock %}

{% block script %} <script type="text/javascript" src="https://cdn.datatables.net/1.10.2/js/jquery.dataTables.min.js"></script> {% endblock %}



{% block style%}
<style>
    /* Make the image fully responsive 
  .carousel-inner img {
    width: 100%;
    height: 50%;
  }*/
</style>

{% endblock %}

{% block content %}

<div class="container-fluid">
    <hr>
        <b> Malware ID : [ {{posts['name'] }} ] : </b> 
        {% if posts['connected'] %}
        <span class="badge badge-success"> Connected </span> 
        {% else %}
        <span class="badge badge-warning"> Not Connected </span>
        {% endif %}
        last update time : {{posts['updateT'] }}
    <p> 
        Current task information:
    </p>    
    
    <div class="table-responsive">
        <table class="table table-bordered table-dark">
            <thead>
                <tr class="table table-danger">
                    <th>Task ID</th>
                    <th>taskType</th>
                    <th>StartTime</th>
                    <th>Task repeat</th>
                    <th>State</th>
                    <th>taskData</th>
                </tr>
            </thead>

            <tbody>
                {% for post in posts['defaultTasks'] %}
                <tr class="info">
                    <td> <b>{{ post['taskID'] }}</b> </td>
                    <td> {{ post['taskType'] }} </td>
                    <td>
                        <span class="badge badge-info"> {{ post['StartT'] }} </span>
                    </td>
                    <td> {{ post['repeat'] }} </td>
                    <td>
                        {% if post['state'] == 0 %}
                            <span class="badge badge-info"> pending </span>
                        {% elif post['state'] == 1 %}
                            <span class="badge badge-success"> finished </span>
                        {% elif post['state'] == 2 %}
                            <span class="badge badge-warn"> running </span>
                        {% else %}
                            <span class="badge badge-danger"> error </span>
                        {% endif %}
                    </td>
                    <td> {{ post['taskData'] }} </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

    </div>

    <div class="container">
        <h3>Log:</h3>
        <pre id="log"></pre>
    </div>


</div>


<script>

    $(document).ready(function () {
        $('[data-toggle="tooltip"]').tooltip();
    });

    $(document).ready(function() {
        $('#example').DataTable();
    } );

    $(document).on("click", ".open-AddBookDialog", function () {
        var cardId = $(this).data('id');
        //var servername = $(this).data('server');
        //const element = document.getElementById("gpuName");
        //element.innerHTML = servername;
        $(".modal-body #gpuIndex").val( cardId );
        $(".modal-body #bookId").val( cardId );
    });

    $(document).ready(function(){
        $('[data-toggle="popover"]').popover(
            { trigger: 'focus'}
        );   
    });

</script>

{% endblock %}