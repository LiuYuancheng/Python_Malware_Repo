# Malware Simulation Project 
### Python Malicious Activities Simulation Program Repository



**Program Design Purpose**: This repository provides a collection of Python programs that simulate a wide range of malicious activities and malware behaviors. These simulations cover common attack vectors, including compromised credentials, penetration, phishing, brute force attacks, distributed denial-of-service (DDoS), remote control operations, trojans, man-in-the-middle (MITM) attacks, insider threats, and more. The repository is designed for the following purposes:

- **Education**: To provide resources for cybersecurity courses of all levels, including materials for lab assignments and demonstrations on malware behavior.
- **Competition**: To supply tools for use in cybersecurity competitions, such as Capture the Flag (CTF) events and red teaming exercises.
- **Training**: To support workshops and training sessions focused on cyberattack and defense techniques for company employees, semi-professionals, and other participants.
- **Testing**: To assist in evaluating and testing the effectiveness of security solutions and malware detection programs.
- **Research**: To enable research in areas such as detecting unusual network traffic, identifying trojans, assessing risk responses, and analyzing penetration techniques.

> Important: The program and script in this repository can only be used for education, training and research, please don't apply it on cyber attack. 

```python
# Created:     2023/07/30
# Version:     v_0.1.2
# Copyright:   Copyright (c) 2023 LiuYuancheng
# License:     MIT License
```

**Table of Contents**

[TOC]

------

### Introduction 

In cybersecurity research, working with actual malware can be risky, as some malicious programs may unintentionally damage systems. To address this challenge, this project aims to create a repository of scripts and programs that simulate various malicious activities without the associated risks. Key attack vectors include compromised credentials, phishing, brute force attacks, denial of service, trojans, man-in-the-middle attacks, and insider threats. The malicious actions span file theft, web shell attacks, phishing email generation, DDoS, backdoor installation, ARP spoofing, malware injection, and more, providing a comprehensive toolset for simulating and studying cyberattacks.

The repository will provide five types of attack modules, offering a safe environment for research, education, and testing:

- **Credentials Compromise Module**: Simulates attacks that compromise sensitive security information, such as stealing files or scanning user activity. Key functions include : `File/data stolen`, `Cmd history scanning`, `User password crack` and `Browser cookie hijacking`.
- **Phishing and Scam Module**: These modules generate phishing emails or scams to mislead users into downloading malicious resources or viewing malicious links. Functions include: `Phishing email generation`, `Scam Telegram message boom` , `backdoor/spy trojan` and `Scam popup advertisement generation`. 
- **Scan and Record Module**: These modules record user actions and scan the victim's network/target. Functions include: `Network scanning`, `Service probing`, `Traffic mirroring` , `Screen recording` and `Keyboard logging` .
- **Denial of Service Module**: These modules disable or interrupt the targeted victim's service. Functions include:  `ARP spoofing`, `Man in the middle attack` , `DDoS Attack`, `Hardware freeze/disable` and `Packet blocking `

- **System Destruction Module** : These modules are used to destroy the target OS. Functions include: `File-sys destructing`, `Malware injection` , `FDI and FCI`, `malware protection watchdog` and `python-lib hijack`

Most of the malware simulations are written in Python and C, with some requiring integration with external attack tools. The repository covers a broad range of attack vectors and malicious actions, making it a versatile resource for cybersecurity education, competition, research, and testing.

| Idx  | Attack Vector                 | Malicious action                                             |
| ---- | ----------------------------- | ------------------------------------------------------------ |
| 1    | Compromised Credentials       | File stolen, critical data leakage/capture, history scanning, keyboard input logging, screen shot capture, browser cookie archiving. |
| 2    | Privilege escalation          | Web shell, Pickle bomb, library hijacking.                   |
| 3    | Phishing                      | Phishing email generation, scam email generation.            |
| 4    | Brute Force                   | Web account login brute force crack and takeover. Password dictionary crack attack |
| 5    | Distributed Denial of Service | DDoS attack on web, OT-system(PLC), different service ( such as email server ). |
| 6    | Trojans                       | Backdoor trojan, spy trojan                                  |
| 7    | Man-in-the-Middle Attacks     | Arp spoofing , traffic block , packets drop, packets data replacement. |
| 8    | Insider threats               | Malware camouflage, Malicious(code/program) inject, device I/O Compromise (mouse, keyboard, screen frozen), malware process protection watchdog. |



------

### Malicious Activities Simulation Program

In this section we will introduce the detail of each Malicious Activities Simulation Program



#### Backdoor Trojan Simulation Program

The **Backdoor Trojan Simulation** is designed to mimic the behavior of a real backdoor trojan to create a vulnerable point / interface on your system, providing a practical demonstration of how such malware operates in a controlled environment. The system work flow diagram is shown below:

![](doc/img/rm/rm_03.png)

This system consists of three main components that work together to simulate a full-fledged backdoor attack scenario:

- **Backdoor Trojan Program**: This malicious program runs on the victimâ€™s machine, opening a backdoor that allows an attacker to remotely execute commands, steal credential files, perform harmful actions on the host computer, or inject other malware without authorization. The trojan remains hidden until activated by the hacker, making it difficult for security systems to detect it initially.

- **P2P Trojan Connector**: This is a console-based peer-to-peer remote control tool used by attackers to interact with the backdoor trojan. It enables hackers to execute destructive actions such as renaming files or filling the user's home directory with garbage files. The P2P connector supports multiple hackers controlling the same trojan simultaneously, creating a collaborative attack scenario.

- **Trojan Controller Hub**: This is a graphical user interface (GUI)-based control center, allowing attackers to manage multiple backdoor trojans on different victim machines. It provides batch control functionality, enabling hackers to launch coordinated attacks, such as wiping out all files in the home directories of every compromised machine. One hacker can control multiple trojans through this centralized hub.

Detailed project document link : https://github.com/LiuYuancheng/Python_Malwares_Repo/tree/main/src/backdoorTrojan



#### DoS Attack Simulation Program

The **Distributed Denial-of-Service (DDoS) Attack Simulation** is designed to emulate large-scale DDoS attacks in a controlled environment, showcasing how malicious actors can disrupt network services by overwhelming a target with a flood of traffic. DDoS attacks are one of the most common and straightforward methods used by hackers to incapacitate services such as websites, servers, or entire networks. This simulation aims to replicate such attacks by generating massive numbers of concurrent network requests to a targeted service, current the attack simulation covers 10 type of different protocols: `SSH`, `HTTP(s)`, `NTP`, `FTP`, `TCP`, `UDP`, `SMB`, `Modbus-TCP`, `SMTP` and `POP3`. The system work flow diagram is shown below:

![](doc/img/rm/rm_04.png)

The DDoS attack simulation system consists of three main components:

1. **DDoS Attacker Program**: This program runs on individual nodes and uses a multithreaded attack pool to initiate hundreds of parallel threads, simulating a high-volume DDoS attack. The user can configure the attack parameters, and the system provides 10 different types of service attack actors. Users can also integrate custom attack scripts into the attacker for more tailored simulations.
2. **DDoS Attack Actors Repository**: This repository contains a variety of attack actors that generate different types of network requests, such as SSH, HTTPS GET/POST, SMB login, and others. Each attack actor is instantiated in its own thread and added to the attack pool, where it continuously sends requests to the target.
3. **DDoS Control Hub**: The control hub links multiple DDoS attacker programs together, allowing the user to monitor the attack in real time and manage individual attackers through a web interface. This centralized system gives users control over multiple attacks simultaneously, enabling batch operations and state monitoring.

Detailed project document link : https://github.com/LiuYuancheng/Python_Malwares_Repo/tree/main/src/ddosAttacker



#### ARP Spoofing Attack Simulation Program

The **ARP Spoofing Attack Simulation** is designed to emulate network-level attacks by manipulating the Address Resolution Protocol (ARP), which is essential for translating IP addresses to MAC addresses in a local network. This program leverages the popular tool **Ettercap** to execute ARP spoofing attacks, enabling attackers to intercept, block, or manipulate network traffic. By integrating this ARP spoofing simulation into a larger Command and Control (C2) Emulation system, the program offers a versatile tool for testing network vulnerabilities and defense mechanisms. The system work flow diagram is shown below:

![](doc/img/rm/rm_05.png)

The **ARP Spoofing Attacker** extends the functionality of the standard C2 malware simulation module by incorporating a custom **Ettercap Wrapper**. This wrapper enables precise control over network traffic through ARP poisoning, targeting routers, switches, or other devices in specific network subnets. This allows the attacker to either drop specific packets, block entire traffic streams, or perform more advanced attacks like Man-in-the-Middle (MitM).

By simulating ARP spoofing attacks in this controlled environment, the system provides valuable insights into the risks posed by such attacks and allows security teams to test their mitigation strategies against common network-based threats.

Detailed project document link : https://github.com/LiuYuancheng/Python_Malwares_Repo/tree/main/src/ettercapWrapper













------



The malware programs currently we provide ( configurable via ansible and deploy to env ) are : 

1. **Backdoor Trojan system**  : A backdoor trojan system which contents a watch dog protected backdoor trojan, a peer to peer single trojan controller and a multiple trojans control hub system.
2. **DDoS Attacker** :  A DDoS attack management system can plug different client to launch DDoS attack. 
3. **Program/Malware Watchdog** : robust watchdog program designed to bind to target programs, diligently monitor their execution states, and ensure uninterrupted functionality.
4. **Phishing email sending** : Use GPT3.5 generate email (normal email contents) then bind different phishing malware as attachment and link.  
5. **Password cracker** : Auto brute force break a password protected zip file or a web login with only user name and password. Use AI to split the dictionary to human generated password and the machine generated password to increate the cracking speed. 

Next develop: 

- [ ] Ransomware system (ransomware + payment web)
- [ ] Use AI to build the normal user time line. 
- [ ] Password cracker : Search the real user (prompt) from internet based on the user name, then use AI to filter and get the password with high possibility ( such us birthday match, children name ) . 



------

### Malware Detail





#### DDoS Attacker

The DDoS attacker system contents 3 main parts :

1. The **DDoS Attacker** program is running on single nodes with a attack thread pool to start several hundreds of parallel threads to implement the attack at the same time based on the user's config. Currently we provide 10 different categories service attack actors and user can also easily plug their customized attack program in the attacker.
2. The **DDoS Attack Actors** **Repository** contents several attack actors to send different kinds of network request (such SSH, https-GET, https-POST, SMB login...) to the target. Each attack actor object will be assembled in a attack thread and put in to the attack pool of the related DDoS attacker.
3. The **DDos Control Hub** is used to link all the DDoS attackers together so the user can monitor the current attack state and control each DDoS attacker via the hub's web interface.

![](doc/img/ddos/system.png)

To use the DDoS Attacker, please refer to this document: [link to the DDoS Attacker usage document](src/ddosAttacker/readme.md)



#### Program/Malware Watchdog

**Project Design Purpose** : During participating the cyber exercise as red team member, we found that the injected malware or attack launching program can easy be stopped by the blue team or defense program / mechanisms via killing the process / deleting the file. To address this, our project aims to develop a robust watchdog program designed to bind to target programs, diligently monitor their execution states, and ensure uninterrupted functionality.

- **Continuous Monitoring :** Establish a vigilant watchdog program that binds seamlessly to the target program, enabling real-time monitoring of its execution state.
- **Dynamic Response Mechanism : **Implement a responsive system that, in the event of the target program being closed or its process terminated, automatically initiates a new, independent process to resume program execution.
- **File Integrity and Recovery : **Create a safeguard mechanism capable of detecting instances where the target program file is deleted. Upon identification, the watchdog will promptly restore the program from a designated backup, ensuring minimal downtime.

The watchdog not only shields the program during execution, but also can be used  in the **Cyber Exercise Red Teaming**, **Service Program Protection** and **Malware Action Detection Research**. The user can bind the watchdog to a single program to make it protect itself or hook several programs with watchdog to build a protection chain to make them auto protect each other.

![](doc/img/watchdog/overview.png)

To use the program watchdog, please refer to this document: [link to the watchdog usage document](src/processWatchDog/readme.md)



#### Red Team C2Emulator 

**Project Design Purpose** : The Red Team Command and Control (RTC2) server, commonly known as a C&C server, plays a pivotal role in cyber exercises and ranges. It serves as a centralized hub that red team members use to control and communicate with simulated compromised victims. This command center enables red team members or attackers to seamlessly issue instructions to the compromised machines, collect data from them, and coordinate various malicious activities within the exercise program. Our goal is to offer a comprehensive C2 server emulation solution designed for cyber exercise red team members. This solution allows them to seamlessly integrate different probing programs and malicious action programs, providing dynamic monitoring, scheduling, and control capabilities. The versatility of our solution makes it applicable across a range of fields, offering a robust platform for enhancing cyber defense readiness and testing the resilience of security measures.

![](doc/img/c2Emulator/overview.png)

The system can be applied on below fields : 

**Cyber Exercise Red Team Malicious C2 Servers Simulation **

- **Botnet Control:** Cybercriminals use C2 servers to control networks of compromised computers (botnets) for various malicious activities, such as launching DDoS attacks, stealing sensitive information, spreading malware, and more.
- **Remote Control:** C2 servers provide attackers with a means to remotely issue commands to compromised systems, allowing them to manipulate and control the infected machines.

**Defensive C2 Frameworks **

- **Red Team Operations:** In the context of cybersecurity exercises, red teams (ethical hackers) may use C2 frameworks to simulate the tactics, techniques, and procedures (TTPs) of real-world adversaries. This helps organizations test their defenses and improve their incident response capabilities.
- **Training and Simulation:** Security professionals use C2 frameworks for training purposes, allowing them to understand and practice responding to simulated cyber threats in a controlled environment.

The RTC2 ( red team command and control ) system will provide a multi-threading based client which users can easily hook the client into their malicious action program to integrate in the RTC2 system.  The RTC2 server not only offers a robust back-end but also comes equipped with a user-friendly web interface and an HTTP request handler API. So the users to can remote control the integrated malware effortlesslyâ€”either through a web browser or their custom programs. This combination of adaptability and accessibility enhances the user experience, providing a versatile platform for managing and orchestrating their cyber exercise scenarios.

To use the c2Emulator program , please refer to this document: [link to the c2Emulaor usage document](src/c2Emulator/readme.md)



#### False Modbus Command Injector

**Program design purpose :** The objective of this project is to develop a demonstration and workshop utilizing the Railway (Metro) IT/OT System Cyber Security Test Platform, the Red Team Command and Control (C2) System, and the Modbus false data injector program for FDI & FCI attack on OT system. Our aim is to showcase how a hacker (red team member) could potentially launch an Operational Technology (OT) Cyber Attack on the programmable logic controllers (PLCs) governing railway train control, with the potential consequence of causing a collision accident between two trains. This particular attack scenario is proposed as one of the demonstration cases for the Cross Sword 2023 Test-Run, providing a realistic and controlled environment to assess the cybersecurity resilience of the railway infrastructure.

To use the False Modbus command and injection attack program, please refer to this document: [link to the false cmd injector document](src/falseCmdInjector/readme.md)



#### ARP Spoofing Attacker 

**Program design purpose** :  We want to create a ARP Spoofing Attacker which can be integrated in our C2 Emulation system to use the comprehensive suite software [Ettercap](https://www.ettercap-project.org/) to implement the ARP Spoofing attack to block/drop the specific packet send from / to the OT system HMI.  This program will be used for the [Cross Sword 2023 Cyber Exercise](https://www.linkedin.com/posts/natoccdcoe_crossedswords-activity-7140986334961217536-7dM5/?utm_source=share&utm_medium=member_desktop) test run Railway OT system attack demo.

This Ettercap wrapper ARP Spoofing malware is used to let the red team attacker can apply different kinds of packet filter on the network traffic via using Ettercap's ARP spoofing function on the router/switch to launch the packet drop, traffic block or even man in the middle attack. The ARP spoofing attacker is extended from the standard c2BackdoorTrojan module `<c2TestMalware>`by adding the our customized Ettercap Wrapper module, so the C2 Emulation system control it broad cast the ARP poisoning message to the railway HMI mode, the operational room subnet's switch/router and the related connected PLC sets.

To use the C2Ettercap wrapper, please refer to this document: [link to the ARP spoofing attacker usage document](src/ettercapWrapper/readme.md)





------

>  Last edit by LiuYuancheng (liu_yuan_cheng@hotmail.com) at 29/10/2023, if you have any problem please free to message me.