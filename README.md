# Python_Malware_Repo
We want to create a repository which can provide different "Malwares" (or program which can simulate the malware's action ) which are written by Python, the malwares will content phishing email generator, backdoor trojan, screen freezer, key logger, malware process watchdog protector, DDoS attacker, traffic data blocker / replacer , password cracker and so on for below purposes :

1. **Education** for any level of cyber security course about malware / program harmful action or the related course lab assignment / demo. 
2. **Training** for company employees, semi-professionals such as the workshop about the cyber attack and defense. 
3. **Development or cluster management** for cluster admin to remote manage cloud computing infra (with out using credentials ) such as do program hot update or software deployment.
4. **Testing** for the security solution program / malware detection program to detect the malware.
5. **Research** in cluster network unusual/exception traffic detection, trojan detection, risk respond,  penetration action detection.

[TOC]

------

### Introduction 

Most the malwares in this repository are implemented by python and C, some program need to work together with attack tool / software. The cyber attack vectors [8] and the malicious action [18] we provide are : 

| Idx  | Attack Vector                 | Malicious action                                             |
| ---- | ----------------------------- | ------------------------------------------------------------ |
| 1    | Compromised Credentials       | File stolen, critical data leakage/capture, history scanning, keyboard input logging, screen shot capture, browser cookie archiving. |
| 2    | Weak Credentials              | Password dictionary crack attack ( zip file )                |
| 3    | Phishing                      | Phishing email generation, scam email generation.            |
| 4    | Brute Force                   | Web account login brute force crack and takeover.            |
| 5    | Distributed Denial of Service | DDoS attack on web, OT-system(PLC), different service ( such as email server ). |
| 6    | Trojans                       | Backdoor trojan                                              |
| 7    | Man-in-the-Middle Attacks     | Arp spoofing , traffic block , packets drop, packets data replacement. |
| 8    | Insider threats               | Malware camouflage, Malicious(code/program) inject, device I/O Compromise (mouse, keyboard, screen frozen), malware process protection watchdog. |



The malware programs currently we provide are : 

1. **Backdoor Trojan system**  : A backdoor trojan system which contents a watch dog protected backdoor trojan, a peer to peer single trojan controller and a multiple trojans control hub system.



------

### Malware Detail



#### Backdoor Trojan

The Trojan system contents 3 main programs:

1. One **Backdoor Trojan** program running on victim open a backdoor to allow hacker to remote run commands, steal credential files, do harmful action to the host computer or  insert other malware into a host without authorization. 
2. One **P2P Trojan Connector**  which is a console based peer to peer direct trojan remote connector for hacker used to remote control one of the backdoor trojan to do the harmful action such as rename all user's file, full fill user's home folder with garbage files. It allows multiple hackers to control one trojan at the same time. 
3. One **Trojans Controller Hub** which is a UI based trojan management hub used for hacker to manage multiple trojan in different victim host or batch launch attack such as clear all files in every victim computer's home folder. It allows one hacker control multiple trojans at the same time.

The workflow between the backdoor trojan and trojan controller is shown below: 

![](doc/img/trojan_ystem_diagram.png)

To use the backdoor trojan, please refer to this document: [link to the backdoor trojan usage document](src/backdoorTrojan/readme.md)



#### DDoS Attacker

The DDoS attacker system contents 3 main parts :

1. The **DDoS Attacker** program is running on single nodes with a attack thread pool to start several hundreds of parallel threads to implement the attack at the same time based on the user's config. Currently we provide 10 different categories service attack actors and user can also easily plug their customized attack program in the attacker.
2. The **DDoS Attack Actors** **Repository** contents several attack actors to send different kinds of network request (such SSH, https-GET, https-POST, SMB login...) to the target. Each attack actor object will be assembled in a attack thread and put in to the attack pool of the related DDoS attacker.
3. The **DDos Control Hub** is used to link all the DDoS attackers together so the user can monitor the current attack state and control each DDoS attacker via the hub's web interface.

![](doc/img/ddos/system.png)

To use the DDoS Attacker, please refer to this document: [link to the DDoS Attacker usage document](src/ddosAttacker/readme.md)



#### Program Watchdog

**Project Design Purpose** : During participating the cyber exercise as red team member, we found that the injected malware or attack launching program can easy be stopped by the blue team or defense program / mechanisms via killing the process / deleting the file. To address this, our project aims to develop a robust watchdog program designed to bind to target programs, diligently monitor their execution states, and ensure uninterrupted functionality.

- **Continuous Monitoring : **Establish a vigilant watchdog program that binds seamlessly to the target program, enabling real-time monitoring of its execution state.
- **Dynamic Response Mechanism : **Implement a responsive system that, in the event of the target program being closed or its process terminated, automatically initiates a new, independent process to resume program execution.
- **File Integrity and Recovery : **Create a safeguard mechanism capable of detecting instances where the target program file is deleted. Upon identification, the watchdog will promptly restore the program from a designated backup, ensuring minimal downtime.

The watchdog not only shields the program during execution, but also can be used  in the **Cyber Exercise Red Teaming**, **Service Program Protection** and **Malware Action Detection Research**. The user can bind the watchdog to a single program to make it protect itself or hook several programs with watchdog to build a protection chain to make them auto protect each other.

![](doc/img/watchdog/overview.png)



------

>  Last edit by LiuYuancheng (liu_yuan_cheng@hotmail.com) at 29/10/2023, if you have any problem please free to message me.